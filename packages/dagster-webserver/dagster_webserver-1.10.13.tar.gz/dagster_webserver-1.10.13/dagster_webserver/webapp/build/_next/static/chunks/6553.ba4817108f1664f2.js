"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6553],{63827:function(e,n,t){t.d(n,{EP:function(){return E},NX:function(){return O},VM:function(){return R}});var i=t(52322),s=t(94466),o=t(30604),l=t(56876),r=t(48177),a=t(2784),c=t(13543),u=t(15569),d=t(20913),p=t(86224),h=t(41349),x=t(95426),m=t(9979),g=t(9129),v=t(29872),f=t(71498),y=t(2281),j=t(1168),S=t(84991),k=t(26496),w=t(49515),C=t(71271);let b=e=>{let{run:n}=e,{id:t,canTerminate:l}=n,[r,c]=(0,a.useState)(!1),u=(0,a.useCallback)(()=>c(!1),[]),d=(0,a.useCallback)(async e=>{let{errors:n}=e,i=t&&n[t];i&&"message"in i&&await (0,v.B)({message:i.message,icon:"error",intent:"danger"})},[t]);return t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.zx,{icon:(0,i.jsx)(o.JO,{name:"cancel"}),intent:"danger",disabled:r,onClick:()=>c(!0),children:"Terminate"}),(0,i.jsx)(x.A,{isOpen:r,onClose:u,onComplete:d,selectedRuns:{[t]:l}})]}):null};function I(e,n){let t=e.keys.map(e=>{var t;return e&&(null===(t=n.steps[e])||void 0===t?void 0:t.state)||u.TN.PREPARING});return{...e,present:e.keys.length>0,failed:e.keys.length&&t.includes(u.TN.FAILED),finished:t.every(e=>[u.TN.FAILED,u.TN.SUCCEEDED].includes(e))}}let E=e=>d.cv.has(e.status),R=e=>e.executionPlan&&d.hd.has(e.status),O=e=>{var n,t;let{metadata:s,graph:o,run:a}=e,u=(0,C.n)(a),x=(0,m.J)(a),v=null==a?void 0:null===(n=a.executionPlan)||void 0===n?void 0:n.artifactsPersisted,O=I(e.selection,s),T=function(e,n,t){let i=e.tags.find(e=>e.key===p.H.StepSelection);return i?I({keys:(0,y.V)(n,i.value).all.map(e=>e.name),query:i.value},t):null}(a,o,s),_=null===(t=a.tags)||void 0===t?void 0:t.some(e=>e.key===p.H.IsResumeRetry&&"true"===e.value),P=(0,g.D)(),D=async e=>{if(!a||!u||!a.pipelineSnapshotId)return;let n=(0,h.DP)({run:a,selection:e,repositoryLocationName:u.match.repositoryLocation.name,repositoryName:u.match.repository.name});await P.onClick(a,n,!1)},L={icon:"cached",scope:"*",title:"All steps in root run",tooltip:"Re-execute the pipeline run from scratch. Shift-click to adjust tags.",disabled:!E(a),onClick:e=>P.onClick(a,S.hmq.ALL_STEPS,e.shiftKey)},A={icon:"linear_scale",scope:(null==T?void 0:T.query)||"*",title:"Same steps",disabled:!T||!(T.finished||T.failed),tooltip:(0,i.jsxs)("div",{children:[T&&T.present?T.finished?"Re-execute the same step subset used for this run:":"Wait for all of the steps to finish to re-execute the same subset.":"Re-executes the same step subset used for this run if one was present.",(0,i.jsx)(N,{selection:T})]}),onClick:()=>D(T)},F={icon:"op",scope:O.query,title:O.keys.length>1?"Selected steps":"Selected step",disabled:!O.present||!(O.finished||O.failed),tooltip:(0,i.jsxs)("div",{children:[O.present?O.finished?"Re-execute the selected steps with existing configuration:":"Wait for the steps to finish to re-execute them.":"Select a step or type a step subset to re-execute.",(0,i.jsx)(N,{selection:O})]}),onClick:()=>D(O)},V={icon:"arrow_forward",title:"From selected",disabled:!E(a)||1!==O.keys.length,tooltip:"Re-execute the pipeline downstream from the selected steps.",onClick:async()=>{if(!a.executionPlan)return console.warn("Run execution plan must be present to launch from-selected execution"),Promise.resolve();let e=O.keys.map(e=>"".concat(e,"*")).join(","),n=(0,f.vR)(c.T.flagSelectionSyntax)?O.keys.map(e=>'name:"'.concat(e,'"+')).join(" or "):e,t=(0,w.Z)(o,n).all.map(e=>e.name);await D({keys:t,query:e})}},q=R(a),U={icon:"arrow_forward",title:"From failure",disabled:!q,tooltip:q?"Retry the pipeline run, skipping steps that completed successfully. Shift-click to adjust tags.":"Retry is only enabled when the pipeline has failed.",onClick:e=>P.onClick(a,S.hmq.FROM_FAILURE,e.shiftKey)};v||[F,A,U,V].forEach(e=>{e.disabled=!0,e.title="Retry and re-execute are only enabled on persistent storage. Try rerunning with a different storage configuration."});let K=[L,A,F,V,U],z=O.present?F:q&&_?U:(null==T?void 0:T.present)?A:null,J=v&&z?z:L;return(0,i.jsxs)(l.Z,{direction:"row",spacing:8,children:[(0,i.jsx)(r.x,{flex:{direction:"row"},children:(0,i.jsx)(k.D,{runCount:1,primary:J,options:K,title:"*"===J.scope?"Re-execute all (*)":J.scope?"Re-execute (".concat(J.scope,")"):"Re-execute ".concat(J.title),tooltip:(null==x?void 0:x.tooltip)?null==x?void 0:x.tooltip:a.hasReExecutePermission?void 0:j.Qr,icon:null==x?void 0:x.icon,disabled:(null==x?void 0:x.disabled)||!a.hasReExecutePermission})}),d.cv.has(a.status)?null:(0,i.jsx)(b,{run:a}),P.launchpadElement]})},N=e=>{let{selection:n}=e;return(0,i.jsx)("div",{style:{paddingLeft:"10px"},children:((null==n?void 0:n.keys)||[]).map(e=>(0,i.jsx)("span",{style:{display:"block"},children:"* ".concat(e)},e))})}},16553:function(e,n,t){t.r(n),t.d(n,{RunRoot:function(){return eZ},default:function(){return eB}});var i=t(73235),s=t(52322),o=t(48177),l=t(71018),r=t(54854),a=t(15997),c=t(18984),u=t(3217),d=t(56328),p=t(2784),h=t(7267),x=t(47933),m=t(8941),g=t(26834),v=t(94466),f=t(30604),y=t(44067),j=t(13543),S=t(35505),k=t(89628),w=t(54786),C=t(13070),b=t(4226),I=t(63827),E=t(38995),R=t(15569),O=t(21876),N=t(13547),T=t(71498),_=t(34515),P=t(9628),D=t(46473),L=t(40552),A=t(84991),F=t(93781);let V=e=>{(0,p.useEffect)(()=>{let n=document.querySelector('link[rel="icon"][type="image/svg+xml"]');if(!n)return;let t=n.getAttribute("href");return n.setAttribute("href",e),()=>{t&&n.setAttribute("href",t)}},[e])};var q=t(22710),U=t(56806),K=t(49515),z=t(4993),J=t(75665);let M=e=>{switch(e){case A.VOA.FAILURE:return"/favicon-run-failed.svg";case A.VOA.SUCCESS:return"/favicon-run-success.svg";case A.VOA.STARTING:case A.VOA.STARTED:case A.VOA.CANCELING:return"/favicon-run-pending.svg";default:return"/favicon.svg"}},Q=(0,p.memo)(e=>{let{run:n,runId:t}=e,[i,o]=(0,J.Bz)(),[l,r]=(0,q.q)({queryKey:"selection",defaults:{selection:""}});V(n?M(n.status):"/favicon.svg"),(0,F.j)(n?"".concat((0,P.pv)(n.pipelineName)?"":n.pipelineName," ").concat(t.slice(0,8)," [").concat(n.status,"]"):"Run: ".concat(t));let a=(e,n)=>{let t=n.find(n=>"ExecutionStepFailureEvent"===n.__typename&&n.stepKey===e);t&&(0,N._K)({body:(0,s.jsx)(_.T9,{error:t})})},c=e=>{r(e),o({...i,logQuery:"*"!==e?[{token:"query",value:e}]:[]})},u=(0,U.FE)("RunLogs");return(0,s.jsx)(E.A.Provider,{value:n,children:(0,s.jsx)(w.C,{runId:t,children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(H,{dependency:u,logs:e}),(0,s.jsx)(R.jp,{logs:e,children:r=>(0,s.jsx)(W,{run:n,runId:t,logs:e,logsFilter:i,metadata:r,selectionQuery:l,onSetLogsFilter:o,onSetSelectionQuery:c,onShowStateDetails:a})})]})},t)})}),H=e=>{let{dependency:n,logs:t}=e;return(0,p.useLayoutEffect)(()=>{t.loading||n.completeDependency(U.Os.SUCCESS)},[n,t]),null},$=e=>{switch(e){case"stdout":return b.hi.stdout;case"stderr":return b.hi.stderr;default:return b.hi.structured}},W=e=>{let{run:n,runId:t,logs:i,logsFilter:l,metadata:r,selectionQuery:c,onSetLogsFilter:u,onSetSelectionQuery:d}=e,h=(0,T.vR)(j.T.flagSelectionSyntax),[S,w]=(0,q.q)({queryKey:"logType",defaults:{logType:b.hi.structured}}),E=$(S),[R,N]=(0,p.useState)(null),_=JSON.stringify(Object.keys(r.steps).sort()),P=(0,p.useMemo)(()=>JSON.parse(_),[_]),A=(null==n?void 0:n.executionPlan)&&(0,L.J)(null==n?void 0:n.executionPlan,r.steps),F=(0,p.useMemo)(()=>A&&c&&"*"!==c?(0,K.Z)(A,c).all.map(e=>e.name):[],[A,c]),V=(0,p.useMemo)(()=>({query:c,keys:F}),[F,c]),{logCaptureInfo:U,computeLogFileKey:J,setComputeLogFileKey:M}=(0,z.r)({stepKeys:P,selectionStepKeys:F,metadata:r,defaultToFirstStep:!1}),Q=(0,p.useMemo)(()=>A?l.logQuery.filter(e=>e.token&&"query"===e.token).reduce((e,n)=>(e.push(...(0,K.Z)(A,n.value).all.map(e=>e.name)),e),[]):[],[l.logQuery,A]),[H,W]=(0,p.useState)(null),G=(0,p.useRef)(null);(0,p.useLayoutEffect)(()=>{if(G.current){let e=G.current.getSize();100===e?W("top"):0===e&&W("bottom")}},[]);let X="top"===H,Y="bottom"===H,ee=()=>{var e;null===(e=G.current)||void 0===e||e.changeSize(50),W(null)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(y.O,{ref:G,axis:"vertical",identifier:"run-gantt",firstInitialPercent:35,firstMinSize:56,first:n?n.executionPlan&&A?(0,s.jsx)(m.S,{region:"gantt chart",children:(0,s.jsx)(D.hj,{options:{mode:D.hS.WATERFALL_TIMED},toolbarActions:(0,s.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[(0,s.jsx)(g.u,{content:X?"Collapse":"Expand",children:(0,s.jsx)(v.zx,{icon:(0,s.jsx)(f.JO,{name:X?"collapse_arrows":"expand_arrows"}),onClick:X?ee:()=>{var e;null===(e=G.current)||void 0===e||e.changeSize(100),W("top")}})}),(0,s.jsx)(I.NX,{run:n,graph:A,metadata:r,selection:V})]}),runId:t,graph:A,metadata:r,selection:V,onClickStep:(e,n)=>{let t=F.indexOf(e),i=[],s='"'.concat(e,'"'),o=c;if(n.shiftKey){var l,a;i=[...F.map(e=>c.includes('"'.concat(e,'"'))?'"'.concat(e,'"'):e)],-1!==t?h?(l=o,o="(".concat(l,') and not name:"').concat(e,'"')):i.splice(t,1):h?(a=o,o="(".concat(a,') or name:"').concat(e,'"')):i.push(s)}else if(1===F.length&&-1!==t)h?o="":i=[];else{h?o='name:"'.concat(e,'"'):i=[s];let n=(0,z.c)(r.logCaptureSteps,e);n&&M(n)}h?d(o):d(i.join(", ")||"*")},onSetSelection:d,focusedTime:l.focusedTime})}):(0,s.jsx)(a.t,{icon:"error",title:"Unable to build execution plan"}):(0,s.jsx)(D.ZW,{runId:t}),secondMinSize:56,second:(0,s.jsx)(m.S,{region:"logs",children:(0,s.jsxs)(Z,{children:[(0,s.jsx)(b.KZ,{logType:E,onSetLogType:e=>w(b.hi[e]),filter:l,onSetFilter:u,steps:P,metadata:r,computeLogFileKey:J,onSetComputeLogKey:M,computeLogUrl:R,counts:i.counts,isSectionExpanded:Y,toggleExpanded:Y?ee:()=>{var e;null===(e=G.current)||void 0===e||e.changeSize(0),W("bottom")}}),(null==n?void 0:n.status)==="QUEUED"?(0,s.jsx)(a.t,{icon:"arrow_forward",title:"Run queued",description:"This run is queued for execution and will start soon.",action:(0,s.jsx)(x.rU,{to:(0,O.it)([{token:"status",value:"QUEUED"}]),children:"View queued runs"})}):E===b.hi.structured?(0,s.jsx)(C.S,{logs:i,filter:l,filterStepKeys:Q,filterKey:"".concat(JSON.stringify(l)),metadata:r}):J?(0,s.jsx)(k.h,{logKey:J?[t,"compute_logs",J]:[],logCaptureInfo:U,visibleIOType:b.hi[E],onSetDownloadUrl:N}):(0,s.jsx)(B,{type:E})]})})})})},Z=S.ZP.div.withConfig({componentId:"sc-4e0b8749-0"})(["display:flex;flex-direction:column;height:100%;"]),B=e=>{let{type:n}=e;return(0,s.jsx)(o.x,{flex:{direction:"row",grow:1,alignItems:"center",justifyContent:"center"},style:{background:u.v8()},children:(0,s.jsx)(a.t,{title:"Select a step to view ".concat(n),icon:"warning",description:"Select a step on the Gantt chart or from the dropdown above to view logs."})})};var G=t(79066),X=t(4760);function Y(){let e=(0,i._)(["\n  query RunAssetChecksQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        assetChecks {\n          name\n          assetKey {\n            path\n          }\n        }\n      }\n    }\n  }\n"]);return Y=function(){return e},e}let ee=e=>{let{run:n}=e,t=(0,P.pv)(n.pipelineName),{data:i,loading:o}=(0,X.aM)(en,{variables:{runId:n.id},skip:t});if(o||!i||"Run"!==i.pipelineRunOrError.__typename)return null;let l=t?n.assetCheckSelection:i.pipelineRunOrError.assetChecks;return(0,s.jsx)(G.ms,{assetChecks:l})},en=(0,X.Ps)(Y());var et=t(41349);function ei(){let e=(0,i._)(["\n  query RunAssetsQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        assets {\n          id\n          key {\n            path\n          }\n        }\n      }\n    }\n  }\n"]);return ei=function(){return e},e}let es=e=>{let{run:n}=e,t=(0,P.pv)(n.pipelineName),i=(0,X.aM)(eo,{variables:{runId:n.id},skip:t,fetchPolicy:"no-cache"}),o=(0,p.useMemo)(()=>{let{data:e}=i,s=null;return(null==e?void 0:e.pipelineRunOrError.__typename)==="Run"&&(s=e.pipelineRunOrError.assets.map(e=>e.key)),t?(0,et.Bo)(n):s},[i,n,t]);return(0,s.jsx)(G.mP,{useTags:!0,assetKeys:o})},eo=(0,X.Ps)(ei());var el=t(42266),er=t(56876),ea=t(76154),ec=t(60206);let eu=e=>null;var ed=t(76760),ep=t(59596),eh=t(62458),ex=t(26855),em=t(39361),eg=t(5024);let ev=e=>{let{isOpen:n,onClose:t,pools:i}=e;return(0,s.jsxs)(em.Vq,{isOpen:n,onClose:t,canOutsideClickClose:!0,canEscapeKeyClose:!0,title:"Pools",children:[(0,s.jsx)(o.x,{margin:{horizontal:24,vertical:12},flex:{gap:12},children:i.map(e=>(0,s.jsx)(eg.F,{pool:e},e))}),(0,s.jsx)(em.cN,{topBorder:!0,children:(0,s.jsx)(v.zx,{onClick:t,intent:"primary",children:"Close"})})]})};var ef=t(20913),ey=t(95426),ej=t(12546),eS=t(29872),ek=t(17046),ew=t(6023),eC=t(18328);let eb=e=>{var n,t;let{run:i,isJob:o}=e,l=i.hasRunMetricsEnabled,[r,a]=(0,p.useState)(null),{rootServerURI:c}=(0,p.useContext)(ej.I),{refetch:u}=(0,p.useContext)(et.Lw),d=(0,h.k6)(),[x]=(0,X.Db)(ek.dP),m=async()=>{var e;(null===(e=(await x({variables:{runId:i.id}})).data)||void 0===e?void 0:e.freeConcurrencySlots)&&await (0,eS.B)({intent:"success",icon:"check_circle",message:"Freed concurrency slots"})},y=(0,eC.$y)({repositoryName:null===(n=i.repositoryOrigin)||void 0===n?void 0:n.repositoryName,repositoryLocationName:null===(t=i.repositoryOrigin)||void 0===t?void 0:t.repositoryLocationName,run:i,isJob:o});return(0,s.jsxs)("div",{children:[(0,s.jsxs)(er.Z,{direction:"row",spacing:8,children:[(0,s.jsx)(eu,{runId:i.id}),y.disabledReason?(0,s.jsx)(g.u,{content:y.disabledReason,useDisabledButtonTooltipFix:!0,children:(0,s.jsx)(v.zx,{icon:(0,s.jsx)(f.JO,{name:y.icon}),disabled:!0,children:y.label})}):(0,s.jsx)(ew.A,{icon:(0,s.jsx)(f.JO,{name:y.icon}),to:y.to,children:y.label}),(0,s.jsx)(v.zx,{icon:(0,s.jsx)(f.JO,{name:"tag"}),onClick:()=>a("config"),children:"View tags and config"}),i.allPools&&i.allPools.length?(0,s.jsx)(g.u,{content:"View pools",position:"top",targetTagName:"div",children:(0,s.jsx)(v.zx,{icon:(0,s.jsx)(f.JO,{name:"concurrency"}),onClick:()=>a("pools")})}):null,(0,s.jsx)(ea.J2,{position:"bottom-right",content:(0,s.jsxs)(ec.v2,{children:[(0,s.jsx)(g.u,{content:"Loadable in dagster-webserver-debug",position:"left",targetTagName:"div",children:(0,s.jsx)(ec.sN,{text:"Download debug file",icon:"download_for_offline",onClick:()=>window.open("".concat(c,"/download_debug/").concat(i.id))})}),i.status===A.VOA.QUEUED?(0,s.jsx)(ec.sN,{tagName:"button",icon:"history_toggle_off",text:"View queue criteria",intent:"none",onClick:()=>a("queue-criteria")}):null,l&&ed.G?(0,s.jsx)(ec.sN,{tagName:"button",icon:"asset_plot",text:"View container metrics",intent:"none",onClick:()=>a("metrics")}):null,i.hasConcurrencyKeySlots&&ef.cv.has(i.status)?(0,s.jsx)(ec.sN,{text:"Free concurrency slots",icon:"lock",onClick:m}):null,i.hasDeletePermission?(0,s.jsx)(ec.sN,{icon:"delete",text:"Delete",intent:"danger",onClick:()=>a("delete")}):null]}),children:(0,s.jsx)(v.zx,{icon:(0,s.jsx)(f.JO,{name:"expand_more"})})})]}),(0,s.jsx)(ex.U,{isOpen:"config"===r,onClose:()=>a(null),mode:i.mode,runConfigYaml:i.runConfigYaml,tags:i.tags,isJob:o}),i.status===A.VOA.QUEUED?(0,s.jsx)(eh.f,{run:i,isOpen:"queue-criteria"===r,onClose:()=>a(null)}):null,l&&ed.G?(0,s.jsx)(ed.G,{runId:i.id,isOpen:"metrics"===r,onClose:()=>a(null)}):null,i.hasDeletePermission?(0,s.jsx)(ep.N,{isOpen:"delete"===r,onClose:()=>a(null),onComplete:()=>{i.repositoryOrigin?d.push((0,eC.jT)({repoName:i.repositoryOrigin.repositoryName,repoLocation:i.repositoryOrigin.repositoryLocationName,pipelineName:i.pipelineName,isJob:o,path:"/runs"})):a(null)},onTerminateInstead:()=>a("terminate"),selectedRuns:{[i.id]:i.canTerminate}}):null,i.hasTerminatePermission?(0,s.jsx)(ey.A,{isOpen:"terminate"===r,onClose:()=>a(null),onComplete:()=>{u()},selectedRuns:{[i.id]:i.canTerminate}}):null,i.allPools&&i.allPools.length?(0,s.jsx)(ev,{isOpen:"pools"===r,pools:i.allPools,onClose:()=>a(null)}):null]})};var eI=t(4498),eE=t(86224),eR=t(71813),eO=t(6317),eN=t(26893);let eT=e=>{let{loading:n,run:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(null==t?void 0:t.startTime)?(0,s.jsx)(ea.J2,{interactionKind:"hover",placement:"bottom",content:(0,s.jsx)(o.x,{padding:16,children:(0,s.jsx)(eR.s9,{run:t,loading:n})}),children:(0,s.jsx)(r.V,{icon:"schedule",children:(0,s.jsx)(eN.v,{timestamp:t.startTime,timeFormat:{showSeconds:!0,showTimezone:!1}})})}):t.updateTime?(0,s.jsx)(r.V,{icon:"schedule",children:(0,s.jsx)(eN.v,{timestamp:t.updateTime,timeFormat:{showSeconds:!0,showTimezone:!1}})}):void 0,(null==t?void 0:t.startTime)&&(null==t?void 0:t.endTime)?(0,s.jsx)(ea.J2,{interactionKind:"hover",placement:"bottom",content:(0,s.jsx)(o.x,{padding:16,children:(0,s.jsx)(eR.s9,{run:t,loading:n})}),children:(0,s.jsx)(r.V,{icon:"timer",children:(0,s.jsx)("span",{style:{fontVariantNumeric:"tabular-nums"},children:(null==t?void 0:t.startTime)?(0,eO.R4)(((null==t?void 0:t.endTime)*1e3||Date.now())-(null==t?void 0:t.startTime)*1e3):"–"})})}):null]})};var e_=t(7055),eP=t(2636),eD=t(45511),eL=t(47333),eA=t(66974),eF=t(91987);let eV=e=>{let{instigationSelector:n,instigationType:t,tickId:i}=e,[l,a]=(0,p.useState)(!1),[c,u]=(0,p.useState)(!1),d=t===eE.H.ScheduleName?"schedule":"sensors",{name:h,repositoryName:x,repositoryLocationName:m}=n,g=(0,eF.kQ)(x,m),v=[{label:"View ".concat(t===eE.H.ScheduleName?"schedule":"sensor"),to:(0,eC.$U)(g,"".concat(t===eE.H.ScheduleName?"/schedules":"/sensors","/").concat(h))},{label:"View tick details",onClick:()=>a(!0)},{label:"View tick logs",onClick:()=>u(!0)}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eA.c,{actions:v,data:{key:"Launched by",value:h},children:(0,s.jsx)(r.V,{icon:d,children:(0,s.jsxs)(o.x,{flex:{direction:"row"},children:[(0,s.jsx)("span",{children:"Launched by\xa0"}),(0,s.jsx)("div",{style:{maxWidth:"140px"},children:(0,s.jsx)(eP.g,{text:h})})]})})}),(0,s.jsx)(eD.X,{isOpen:l,tickResultType:"runs",onClose:()=>a(!1),instigationSelector:n,tickId:i}),(0,s.jsx)(eL.l,{isOpen:c,onClose:()=>u(!1),instigationSelector:n,tickId:i})]})};var eq=t(96798),eU=t(54123),eK=t(20635),ez=t(55638);let eJ=new Intl.Collator(navigator.language,{sensitivity:"base"}),eM=e=>{var n,t;let{assetKeys:i,evaluationId:l}=e,[a,c]=(0,p.useState)(null),u=(0,p.useMemo)(()=>[...i].sort((e,n)=>eJ.compare(e.path.join("/"),n.path.join("/"))),[i]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ea.J2,{placement:"bottom",content:(0,s.jsxs)("div",{style:{width:"400px"},children:[(0,s.jsx)(o.x,{padding:{vertical:8,horizontal:12},border:"bottom",style:{fontWeight:600},children:"Automation condition"}),(0,s.jsx)(o.x,{flex:{direction:"column",gap:16},padding:{vertical:12},style:{maxHeight:"220px",overflowY:"auto"},children:u.map(e=>{let n=(0,ez.p)(e,{view:"automation",evaluation:l});return(0,s.jsxs)(o.x,{padding:{vertical:8,left:12,right:16},flex:{direction:"row",justifyContent:"space-between",alignItems:"center",gap:16},style:{overflow:"hidden"},children:[(0,s.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:8},style:{overflow:"hidden"},children:[(0,s.jsx)(f.JO,{name:"asset"}),(0,s.jsx)(eP.g,{text:e.path.join("/")})]}),(0,s.jsx)(eU.Z,{onClick:()=>c({assetKeyPath:e.path,evaluationId:l}),style:{whiteSpace:"nowrap"},children:"View evaluation"})]},n)})})]}),interactionKind:"hover",children:(0,s.jsx)(r.V,{icon:"automation_condition",children:"Automation condition"})}),(0,s.jsx)(eK.s,{assetKeyPath:null!==(n=null==a?void 0:a.assetKeyPath)&&void 0!==n?n:[],isOpen:!!a,onClose:()=>c(null),evaluationID:null!==(t=null==a?void 0:a.evaluationId)&&void 0!==t?t:""})]})};var eQ=t(89164),eH=t(32549),e$=t(71271);function eW(){let e=(0,i._)(["\n  query RunRootQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        ...RunPageFragment\n      }\n    }\n  }\n\n  ","\n"]);return eW=function(){return e},e}let eZ=()=>{var e;(0,eq.Px)();let{runId:n}=(0,h.UO)();(0,F.j)(n?"Run ".concat(n.slice(0,8)):"Run");let{data:t,loading:i}=(0,X.aM)(eX,{variables:{runId:n}}),a=(null==t?void 0:t.pipelineRunOrError.__typename)==="Run"?t.pipelineRunOrError:null,c=null==a?void 0:a.pipelineSnapshotId,u=(0,e$.n)(a),d=(null==u?void 0:u.match)?(0,eF.kQ)(u.match.repository.name,u.match.repositoryLocation.name):null,x=(0,p.useMemo)(()=>!!(a&&u&&(0,eH.E8)(u.match,a.pipelineName)),[a,u]),m=(0,p.useMemo)(()=>(null==a?void 0:a.tags.find(e=>e.key===eE.H.AssetEvaluationID))||null,[a]),g=(0,p.useMemo)(()=>{if(d){let e=(null==a?void 0:a.tags)||[],n=e.find(e=>e.key===eE.H.TickId);if(n){let t=e.find(e=>e.key===eE.H.ScheduleName||e.key===eE.H.SensorName);if(t){let e={name:t.value,repositoryName:d.name,repositoryLocationName:d.location};return{tickId:n.value,instigationType:t.key,instigationSelector:e}}}}return null},[a,d]),v=null==a?void 0:a.tags.find(e=>e.key===eE.H.Partition);return(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0,width:"100%",height:"100%",overflow:"hidden"},children:[(0,s.jsx)(o.x,{flex:{direction:"row",alignItems:"flex-start"},style:{position:"relative",zIndex:1},children:(0,s.jsx)(l.m,{title:(0,s.jsx)(eY,{run:a,runId:n}),tags:a?(0,s.jsxs)(o.x,{flex:{direction:"row",alignItems:"flex-start",gap:12,wrap:"wrap"},children:[(0,s.jsx)(eI.KG,{status:a.status}),(0,P.pv)(a.pipelineName)?null:(0,s.jsxs)(r.V,{icon:"run",children:["Run of"," ",(0,s.jsx)(eQ.h,{pipelineName:null==a?void 0:a.pipelineName,pipelineHrefContext:d||"repo-unknown",snapshotId:c,size:"small",isJob:x})]}),g?(0,s.jsx)(eV,{instigationSelector:g.instigationSelector,instigationType:g.instigationType,tickId:g.tickId}):null,v&&(0,s.jsx)(eE.i,{tag:v}),(0,s.jsx)(es,{run:a}),(0,s.jsx)(ee,{run:a}),(0,s.jsx)(eT,{run:a,loading:i}),m&&(null===(e=a.assetSelection)||void 0===e?void 0:e.length)?(0,s.jsx)(eM,{assetKeys:a.assetSelection,evaluationId:m.value}):null]}):null,right:a?(0,s.jsx)(eb,{run:a,isJob:x}):null})}),(0,s.jsx)(eG,{data:t,runId:n})]})};var eB=eZ;let eG=e=>{let{data:n,runId:t}=e;return n&&n.pipelineRunOrError?"Run"!==n.pipelineRunOrError.__typename?(0,s.jsx)(o.x,{padding:{vertical:64},children:(0,s.jsx)(a.t,{icon:"error",title:"No run found",description:"The run with this ID does not exist or has been cleaned up."})}):(0,s.jsx)(Q,{run:n.pipelineRunOrError,runId:t}):(0,s.jsx)(Q,{run:void 0,runId:t})},eX=(0,X.Ps)(eW(),el.tQ),eY=e=>{let{run:n,runId:t}=e,i=(0,p.useMemo)(()=>null==n?void 0:n.tags.find(e=>e.key===eE.H.Backfill),[n]);if(i){var o;return(0,s.jsxs)(c.X6,{children:[(0,s.jsx)(x.rU,{to:"/runs",style:{color:u.$()},children:"Runs"})," / ",(0,s.jsx)(x.rU,{to:(0,e_.M)(i.value,!!(null==n?void 0:null===(o=n.assetSelection)||void 0===o?void 0:o.length)),style:{color:u.$()},children:i.value})," / ",t.slice(0,8)]})}return(0,s.jsxs)(c.X6,{style:{display:"flex",flexDirection:"row",gap:6},children:[(0,s.jsx)(x.rU,{to:"/runs",children:"Runs"}),(0,s.jsx)("span",{children:"/"}),(0,s.jsx)("span",{style:{fontFamily:d.b.monospace},children:t.slice(0,8)})]})}},47333:function(e,n,t){t.d(n,{l:function(){return g}});var i=t(73235),s=t(52322),o=t(39361),l=t(48177),r=t(3217),a=t(94466),c=t(99564),u=t(15997),d=t(30604),p=t(14553),h=t(4760),x=t(26893);function m(){let e=(0,i._)(["\n  query TickLogEventsQuery($instigationSelector: InstigationSelector!, $tickId: ID!) {\n    instigationStateOrError(instigationSelector: $instigationSelector) {\n      ... on InstigationState {\n        id\n        instigationType\n        tick(tickId: $tickId) {\n          id\n          status\n          timestamp\n          logEvents {\n            events {\n              ...InstigationEventLog\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return m=function(){return e},e}let g=e=>{let{tickId:n,timestamp:t,instigationSelector:i,isOpen:c,onClose:u}=e;return(0,s.jsxs)(o.Vq,{isOpen:c,onClose:u,style:{width:"70vw",maxWidth:"1200px",minWidth:"800px"},title:(0,s.jsx)("span",{children:t?(0,s.jsxs)("span",{children:[(0,s.jsxs)("span",{children:["Logs for ",i.name,": "]}),(0,s.jsx)(x.v,{timestamp:t,timeFormat:{showSeconds:!0}})]}):(0,s.jsxs)("span",{children:["Logs for ",i.name]})}),children:[n?(0,s.jsx)(v,{instigationSelector:i,tickId:n}):null,(0,s.jsx)(l.x,{background:r.v8(),style:{zIndex:3,position:"relative"},children:(0,s.jsx)(o.cN,{topBorder:!0,children:(0,s.jsx)(a.zx,{onClick:u,children:"Done"})})})]})},v=e=>{let{instigationSelector:n,tickId:t}=e,{data:i,loading:o}=(0,h.aM)(f,{variables:{instigationSelector:n,tickId:t},notifyOnNetworkStatusChange:!0}),r=(null==i?void 0:i.instigationStateOrError.__typename)==="InstigationState"&&(null==i?void 0:i.instigationStateOrError.tick)?null==i?void 0:i.instigationStateOrError.tick.logEvents.events:void 0;if(o)return(0,s.jsx)(l.x,{style:{height:500},flex:{justifyContent:"center",alignItems:"center"},children:(0,s.jsx)(c.f,{label:"Loading logs…"})});if(r&&r.length)return(0,s.jsx)(l.x,{style:{height:500},flex:{direction:"column"},children:(0,s.jsx)(p.g,{events:r})});let x=(null==i?void 0:i.instigationStateOrError.__typename)==="InstigationState"?null==i?void 0:i.instigationStateOrError.tick.status:void 0,m=(null==i?void 0:i.instigationStateOrError.__typename)==="InstigationState"?null==i?void 0:i.instigationStateOrError.instigationType:void 0,g="SENSOR"===m?"https://docs.dagster.io/concepts/partitions-schedules-sensors/sensors#logging-in-sensors":"SCHEDULE"===m?"https://docs.dagster.io/concepts/partitions-schedules-sensors/schedules#logging-in-schedules":void 0;return(0,s.jsx)(l.x,{style:{height:500},flex:{justifyContent:"center",alignItems:"center"},padding:{vertical:48},children:(0,s.jsx)(u.t,{icon:"no-results",title:"No logs to display",description:(0,s.jsxs)(l.x,{flex:{direction:"column",gap:12},children:[(0,s.jsx)("div",{children:"Your evaluation did not emit any logs. To learn how to emit logs in your evaluation, visit the documentation for more information."}),"FAILURE"===x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:"For failed evaluations, logs will only be displayed if your Dagster and Dagster Cloud agent versions 1.5.14 or higher."}),(0,s.jsx)("div",{children:"Upgrade your Dagster versions to view logs for failed evaluations."})]})]}),action:g&&(0,s.jsx)(a.fr,{href:g,rightIcon:(0,s.jsx)(d.JO,{name:"open_in_new"}),children:"View documentation"})})})},f=(0,h.Ps)(m(),p.n)}}]);
//# sourceMappingURL=6553.ba4817108f1664f2.js.map