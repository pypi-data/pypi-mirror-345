name: 'GitHub Release'
description: 'Create a GitHub release'
inputs:
  tag_name:
    description: 'Tag name for the release'
    required: true
  name:
    description: 'Release name'
    required: false
  draft:
    description: 'Create a draft release'
    required: false
    default: 'false'
  prerelease:
    description: 'Mark as prerelease'
    required: false
    default: 'false'
  generate_release_notes:
    description: 'Auto-generate release notes'
    required: false
    default: 'false'
runs:
  using: 'composite'
  steps:
    - name: Create GitHub Release
      shell: bash
      run: |
        # This is a simplified version that would use GitHub CLI or API
        # In a real implementation, you would use the GitHub API to create a release
        
        echo "Creating release for tag ${{ inputs.tag_name }}"
        
        # Get GitHub token from env
        TOKEN="${{ env.GITHUB_TOKEN }}"
        if [ -z "$TOKEN" ]; then
          echo "GITHUB_TOKEN is required"
          exit 1
        fi
        
        # Generate simple release notes if requested
        NOTES=""
        if [ "${{ inputs.generate_release_notes }}" = "true" ]; then
          NOTES="Auto-generated release notes for ${{ inputs.tag_name }}"
        fi
        
        # Construct release info
        RELEASE_NAME="${{ inputs.name }}"
        if [ -z "$RELEASE_NAME" ]; then
          RELEASE_NAME="${{ inputs.tag_name }}"
        fi
        
        # Create release using curl
        REPO="${GITHUB_REPOSITORY}"
        API_URL="https://api.github.com/repos/${REPO}/releases"
        
        echo "Creating release on $API_URL"
        curl -X POST \
          -H "Authorization: token $TOKEN" \
          -H "Accept: application/vnd.github.v3+json" \
          $API_URL \
          -d "{
            \"tag_name\": \"${{ inputs.tag_name }}\",
            \"name\": \"$RELEASE_NAME\",
            \"draft\": ${{ inputs.draft }},
            \"prerelease\": ${{ inputs.prerelease }},
            \"generate_release_notes\": ${{ inputs.generate_release_notes }},
            \"body\": \"$NOTES\"
          }"
        
        echo "Release created successfully"