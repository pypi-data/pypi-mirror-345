#!/usr/bin/env python3

import sys
from pentest_tls import port_scanner

def process(ports: list, ip: str, ps_udp, ps_tcp) -> None:
    open_ports = []
    for port in sorted(ports):
        sys.stdout.flush()
        if ps_tcp and port_scanner.scan_tcp_port(ip, port):
            open_ports.append(port)
        elif ps_udp and port_scanner.scan_udp_port(ip, port):
            open_ports.append(port)
    if open_ports:
        print(f"\nOpened: {sorted(open_ports)}")
    else:
        print("\nNo open ports were detected.")
