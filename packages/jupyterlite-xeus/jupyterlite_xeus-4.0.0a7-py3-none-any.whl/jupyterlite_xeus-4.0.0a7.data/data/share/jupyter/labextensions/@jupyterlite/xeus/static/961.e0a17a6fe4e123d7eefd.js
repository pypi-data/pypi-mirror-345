"use strict";(self.webpackChunk_jupyterlite_xeus_extension=self.webpackChunk_jupyterlite_xeus_extension||[]).push([[961],{961:(e,n,t)=>{t.r(n),t.d(n,{IEmpackEnvMetaFile:()=>u,default:()=>f});var o=t(874),r=t(390),s=t(97),a=t(240),l=t(367),i=t(749),c=t(399),g=t(341);const u=new(t(262).Token)("@jupyterlite/xeus:IEmpackEnvMetaFile");var d;async function k(e){const n=l.URLExt.join(l.PageConfig.getBaseUrl(),e),t=await fetch(n,{method:"GET"});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}!function(e){e[e.None=0]="None",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(d||(d={}));const w={id:"@jupyterlite/xeus-kernel:register",autoStart:!0,requires:[c.IKernelSpecs],optional:[i.IServiceWorkerManager,u],activate:async(e,n,t,o)=>{let r=[];try{r=await k("xeus/kernels.json")}catch(e){throw console.log(`Could not fetch xeus/kernels.json: ${e}`),e}const s=e.serviceManager.contents;for(const e of r){const r=await k("xeus/kernels/"+e+"/kernel.json");r.name=e,r.dir=e;for(const[e,n]of Object.entries(r.resources))r.resources[e]=l.URLExt.join(l.PageConfig.getBaseUrl(),n);n.register({spec:r,create:async e=>{const n=!(!(null==t?void 0:t.enabled)&&!crossOriginIsolated);n?console.info(`${r.name} contents will be synced with Jupyter Contents`):console.warn(`${r.name} contents will NOT be synced with Jupyter Contents`);const a=o?await o.getLink(r):"";return new g.WebWorkerKernel({...e,contentsManager:s,mountDrive:n,kernelSpec:r,empackEnvMetaLink:a,browsingContextId:(null==t?void 0:t.browsingContextId)||""})}})}await e.serviceManager.kernelspecs.refreshSpecs()}},v={id:"@jupyterlite/xeus:empack-env-meta",autoStart:!0,provides:u,activate:()=>({getLink:async e=>{const n=e.name;return`${l.URLExt.join(l.PageConfig.getBaseUrl(),`xeus/kernels/${n}`)}`}})},f=[{id:"@jupyterlite/xeus-extension:xeus-kernel-status",autoStart:!0,requires:[o.IToolbarWidgetRegistry,s.IRenderMimeRegistry],activate:async(e,n,t)=>{n&&n.addFactory("Notebook","xeusKernelLogs",(n=>{const s=n.sessionContext;let l,i,c,g,u,k=d.None;const w=()=>{c&&(u=new o.MainAreaWidget({content:c}),u.title.label="Kernel Logs",u.title.icon=r.listIcon,u.id=`${g}-widget`)},v=new r.ToolbarButton({icon:r.listIcon,onClick:()=>{c?(u||w(),u&&(u.isDisposed&&w(),u.isAttached||e.shell.add(u,"main",{mode:"split-bottom"}),e.shell.activateById(u.id))):(0,o.showErrorMessage)("Cannot show logs","Cannot show logs for the current kernel")},tooltip:"Show kernel logs"});return s.kernelChanged.connect((()=>{var e,n,o,r;if(l=null===(e=s.session)||void 0===e?void 0:e.id,i=null===(o=null===(n=s.session)||void 0===n?void 0:n.kernel)||void 0===o?void 0:o.name,k=d.None,!l||!i)return;g=`${i}-${l}`,c=new a.LogConsolePanel(new a.LoggerRegistry({defaultRendermime:t,maxLength:1e3})),c.source=g;const u=new BroadcastChannel(`/kernel-broadcast/${l}`);c.logger&&(c.logger.level="info"),null===(r=c.logger)||void 0===r||r.contentChanged.connect((()=>{const e=document.getElementById(`source:${g}`);if(!e)return;const n=e.lastElementChild;n&&n.scrollIntoView({behavior:"smooth"})})),u.onmessage=e=>{var n,t,o;if(c)switch(e.data.type){case"log":null===(n=c.logger)||void 0===n||n.log({type:"text",level:"info",data:e.data.msg}),k<d.Info&&(k=d.Info,v.addClass("xeus-kernel-status-info"));break;case"warn":null===(t=c.logger)||void 0===t||t.log({type:"text",level:"warning",data:e.data.msg}),k<d.Warning&&(k=d.Warning,v.addClass("xeus-kernel-status-warning"));break;case"error":null===(o=c.logger)||void 0===o||o.log({type:"text",level:"error",data:e.data.msg}),k<d.Error&&(k=d.Error,v.addClass("xeus-kernel-status-error"))}}})),v}))}},v,w]}}]);