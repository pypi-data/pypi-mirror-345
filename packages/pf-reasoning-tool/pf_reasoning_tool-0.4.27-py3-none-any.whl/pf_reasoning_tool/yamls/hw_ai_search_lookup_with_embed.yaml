$schema: https://azuremlschemas.azureedge.net/promptflow/latest/Tool.schema.json
name: HW AI Search Lookup (Internal Embedding) # Tool Name
description: "Custom rag tool for local use"
type: python
category: HW_PF_tools
module: pf_reasoning_tool.tools.hw_ai_search_lookup_with_embed
function: hw_ai_search_lookup_with_embed

# --- Inputs Section ---
inputs:
  connection: # For Search (CustomConnection)
    type: [CustomConnection]
    description: Azure AI Search credentials (key1=URL, key2=KEY).

  index_name:
    type: [string]
    description: Azure AI Search index name.
    dynamic_list:
      func_path: pf_reasoning_tool.tools.hw_ai_search_lookup_with_embed.list_indexes
      func_kwargs:
        connection: ${inputs.connection}

  queries: # Input Query Text(s)
    type: [string, list]
    description: Single query string or list of query strings.

  embeddings_connection: # For Embedding (AzureOpenAIConnection or OpenAIConnection)
    type: [AzureOpenAIConnection, OpenAIConnection] # Allow both standard types
    description: Connection used to embed queries (e.g., Azure OpenAI).
    optional: true # Required only if query_type needs vectors

  embedding_model_name:
    type: [string]
    default: text-embedding-3-large
    description: Embedding deployment (Azure) or model name (OpenAI).

  query_type:
    type: [string]
    default: hybrid
    enum: [keyword, semantic, vector, hybrid, hybrid_semantic]
    description: Type of search to perform.

  top_k:
    type: [int]
    default: 3
    description: Number of results per query.

  text_field:
    type: [string]
    default: content
    description: Field containing main text content.
    dynamic_list:
      func_path: pf_reasoning_tool.tools.hw_ai_search_lookup_with_embed.list_text_fields
      func_kwargs:
        connection: ${inputs.connection}
        index_name: ${inputs.index_name}

  vector_field:
    type: [string]
    default: vector
    description: Field containing vector embeddings.
    dynamic_list:
      func_path: pf_reasoning_tool.tools.hw_ai_search_lookup_with_embed.list_vector_fields
      func_kwargs:
        connection: ${inputs.connection}
        index_name: ${inputs.index_name}

  search_filters:
    type: [string]
    description: OData filter expression (optional).
    optional: true

  select_fields:
    type: [list]
    description: Specific fields to retrieve (optional).
    optional: true

  semantic_config:
    type: [string]
    description: Semantic configuration name (optional).
    optional: true
    dynamic_list:
      func_path: pf_reasoning_tool.tools.hw_ai_search_lookup_with_embed.list_semantic_configs
      func_kwargs:
        connection: ${inputs.connection}
        index_name: ${inputs.index_name}

# --- Outputs Section ---
outputs:
  output:
    type: [list] # Represents List[List[Dict]]
    description: List of results