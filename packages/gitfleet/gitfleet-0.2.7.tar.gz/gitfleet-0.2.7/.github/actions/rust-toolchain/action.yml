name: 'Setup Rust Toolchain'
description: 'Set up Rust toolchain'
inputs:
  targets:
    description: 'Additional Rust targets to install'
    required: false
runs:
  using: 'composite'
  steps:
    - name: Install Rust toolchain
      shell: bash
      run: |
        # Install rustup if not already installed
        if ! command -v rustup &> /dev/null; then
          curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
          source $HOME/.cargo/env
        fi
        
        # Install stable toolchain
        rustup default stable
        
        # Add additional targets if specified
        if [ -n "${{ inputs.targets }}" ]; then
          IFS=',' read -ra TARGETS <<< "${{ inputs.targets }}"
          for target in "${TARGETS[@]}"; do
            target=$(echo $target | xargs) # Trim whitespace
            echo "Adding target: $target"
            rustup target add $target
          done
        fi
        
        # Show installed toolchain info
        rustup show
        cargo --version
        rustc --version