import{_ as z}from"./info-icon.B7PzMJGc.js";import{u as L,d as G,_ as H,c as Q,a as K,b as Z}from"./system-requirements.vue.DmsiSJtw.js";import{_ as j}from"./nuxt-link.p-22Vb__.js";import{n as J,u as W,r as I,H as a,v as X,q as w,A as B,w as p,B as Y,o as u,d as v,y as n,C as ee,b as m,x as te,a as o,c as f,s as U,t as _,F as $,z as oe}from"./entry.DZxwSL9U.js";import{u as ae}from"./fetch.DQpSruNE.js";import{r as N,h as D}from"./http-error-handling.BbcmLHJS.js";import{a as O}from"./artifact-validation.Df82e6rq.js";import{f as se}from"./util.B0gNYUhE.js";import{l as re,c as ne,s as le}from"./form-methods.CkGHM49X.js";const ie=o("title",null,"Report",-1),ue=o("br",null,null,-1),ce=o("h2",{class:"section-header"},"Test Results (Quantitative Analysis)",-1),de={class:"table usa-table usa-table--borderless"},me=o("thead",null,[o("tr",null,[o("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Status"),o("th",{"data-sortable":"",scope:"col",role:"columnheader"}," Quality Attribute Scenario "),o("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Measurement"),o("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Test Case ID"),o("th",{"data-sortable":"",scope:"col",role:"columnheader"},"Message")])],-1),_e={key:0,style:{"background-color":"rgba(210, 232, 221, 255)"}},pe={key:1,style:{"background-color":"rgba(255, 243, 205, 255)"}},fe={key:2,style:{"background-color":"rgba(248, 216, 219, 255)"}},ye={key:3},ve=o("hr",null,null,-1),be=o("h1",{class:"section-header"},"Additional Context",-1),he={style:{"text-align":"right","margin-top":"1em"}},xe=J({__name:"report-form",async setup(qe){let V,F;const S=oe(),g=W("token"),h=I(""),C=I(a().query.artifactId!==void 0),A=I(null),l=I({artifact_type:"report",nc_data:{system:{goals:[{description:"",metrics:[{description:"",baseline:""}]}],problem_type:"classification",task:"",usage_context:"",risks:{fp:"",fn:"",other:""}},data:[{description:"",source:"",classification:"unclassified",access:"",labeling_method:"",labels:[{name:"",description:"",percentage:0}],fields:[{name:"",description:"",type:"",expected_values:"",missing_values:"",special_values:""}],rights:"",policies:""}],model:{development_compute_resources:{gpu:"0",cpu:"0",memory:"0",storage:"0"},deployment_platform:"",capability_deployment_mechanism:"",input_specification:[{name:"",description:"",type:"",expected_values:""}],output_specification:[{name:"",description:"",type:"",expected_values:""}],production_compute_resources:{gpu:"0",cpu:"0",memory:"0",storage:"0"}},system_requirements:[{quality:"",stimulus:"<Stimulus>",source:"<Source>",environment:"<Environment>",response:"<Response>",measure:"<Response Measure>"}]},test_results_id:"",comments:[{content:""}],quantitative_analysis:{}}),x=L(),E=G();if(a().query.artifactId!==void 0){const s=a().query.model,t=a().query.version,c=a().query.artifactId;[V,F]=X(async()=>ae(S.public.apiPath+"/model/"+s+"/version/"+t+"/artifact/"+c,{retry:0,method:"GET",headers:{Authorization:"Bearer "+g.value},onRequestError(){N()},async onResponse({response:r}){var y,d;if(r.ok&&O(r._data)){l.value=r._data.body;const q=r._data.body.nc_data.system.problem_type;if(((y=E.value.find(i=>i.value===q))==null?void 0:y.value)!==void 0&&(l.value.nc_data.system.problem_type=(d=E.value.find(i=>i.value===q))==null?void 0:d.value),r._data.body.nc_data.data.forEach(i=>{var R,k;const b=i.classification;((R=x.value.find(e=>e.value===b))==null?void 0:R.value)!==void 0&&(i.classification=(k=x.value.find(e=>e.value===b))==null?void 0:k.value)}),r._data.body.test_results_id){l.value.test_results_id=r._data.body.test_results_id;const i=await se(g.value,s,t,l.value.test_results_id);A.value=re(i,l.value.nc_data.system_requirements)}}},onResponseError({response:r}){D(r.status,r._data.error_description)}},"$gSGc1Ze9fK")),await V,F()}async function P(){var y;const s=a().query.model,t=a().query.version;let c="";a().query.artifactId===void 0?c=h.value:c=(y=a().query.artifactId)==null?void 0:y.toString();const r={header:{identifier:c,type:"report",timestamp:-1,creator:""},body:l.value};if(O(r))try{await $fetch(S.public.apiPath+"/model/"+s+"/version/"+t+"/artifact",{retry:0,method:"POST",headers:{Authorization:"Bearer "+g.value},body:{artifact:r,force:C.value,parents:!1},onRequestError(){N()},onResponse({response:d}){d.ok&&(le("report",c),C.value=!0,a().query.artifactId===void 0&&(window.location="/report-form?model="+a().query.model+"&version="+a().query.version+"&artifactId="+c))},onResponseError({response:d}){D(d.status,d._data.error_description)}})}catch{}else console.log("Invalid report.")}return(s,t)=>{const c=z,r=w("UsaTextInput"),y=H,d=Q,q=K,i=Z,b=w("UsaButton"),R=j,k=Y;return u(),B(k,{name:"base-layout"},{"page-title":p(()=>[v("Report")]),default:p(()=>[ie,("useRoute"in s?s.useRoute:n(a))().query.artifactId===void 0?(u(),B(r,{key:0,modelValue:n(h),"onUpdate:modelValue":t[0]||(t[0]=e=>ee(h)?h.value=e:null)},{label:p(()=>[v(" Artifact ID "),m(c,null,{default:p(()=>[v(" The Artifact ID this negotiation card "),ue,v(" will be saved under upon submission. ")]),_:1})]),_:1},8,["modelValue"])):te("",!0),m(y,{modelValue:n(l).nc_data.system,"onUpdate:modelValue":t[1]||(t[1]=e=>n(l).nc_data.system=e)},null,8,["modelValue"]),m(d,{modelValue:n(l).nc_data.system_requirements,"onUpdate:modelValue":t[2]||(t[2]=e=>n(l).nc_data.system_requirements=e)},null,8,["modelValue"]),ce,o("table",de,[me,o("tbody",null,[(u(!0),f($,null,U(n(A),e=>(u(),f("tr",{key:e.evidence_id},[e.status=="Success"?(u(),f("td",_e,_(e.status),1)):e.status=="Info"?(u(),f("td",pe,_(e.status),1)):e.status=="Failure"?(u(),f("td",fe,_(e.status),1)):(u(),f("td",ye,_(e.status),1)),o("td",null,[(u(!0),f($,null,U(e.qas_list,(T,M)=>(u(),f("div",{key:M},_(T.id)+" - "+_(T.qa),1))),128))]),o("td",null,_(e.measurement),1),o("td",null,_(e.test_case_id),1),o("td",null,_(e.message),1)]))),128))])]),ve,be,m(q,{modelValue:n(l).nc_data.data,"onUpdate:modelValue":t[3]||(t[3]=e=>n(l).nc_data.data=e)},null,8,["modelValue"]),m(i,{modelValue:n(l).nc_data.model,"onUpdate:modelValue":t[4]||(t[4]=e=>n(l).nc_data.model=e)},null,8,["modelValue"]),o("div",he,[m(b,{class:"secondary-button",onClick:t[5]||(t[5]=e=>("cancelFormSubmission"in s?s.cancelFormSubmission:n(ne))("/"))},{default:p(()=>[v(" Cancel ")]),_:1}),m(R,{target:"_blank",to:{path:"/report-export",query:{model:("useRoute"in s?s.useRoute:n(a))().query.model,version:("useRoute"in s?s.useRoute:n(a))().query.version,artifactId:("useRoute"in s?s.useRoute:n(a))().query.artifactId}}},{default:p(()=>[m(b,{class:"primary-button"},{default:p(()=>[v(" Export ")]),_:1})]),_:1},8,["to"]),m(b,{class:"primary-button",onClick:t[6]||(t[6]=e=>P())},{default:p(()=>[v(" Save ")]),_:1})])]),_:1})}}});export{xe as default};
